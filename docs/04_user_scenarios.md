# 行動シナリオ

## 概要

このドキュメントは、利用者が mcpax を使ってどのように行動するかを時系列で可視化したものである。
各シナリオは「利用者」と「システム（mcpax）」のスイムレーンで表現する。

---

## シナリオ一覧

| ID | シナリオ名 | 説明 |
|----|-----------|------|
| S-001 | 更新を確認してインストールする | メインの利用シナリオ |
| S-002 | 新しいプロジェクトを追加する | 管理対象を増やす |
| S-003 | プロジェクトを削除する | 管理対象から外す |
| S-004 | 管理対象の一覧を確認する | 現在の状態を把握する |
| S-005 | 初期セットアップを行う | 初回利用時 |
| S-006 | プロジェクトを検索する | slug がわからないとき |

---

## S-001: 更新を確認してインストールする

### 前提条件

- config.toml と projects.toml が設定済み
- 管理対象のプロジェクトが登録済み

### トリガー

- Minecraft をバージョンアップした
- 定期的な更新確認をしたくなった

### 行動シナリオ

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 利用者                                                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  (1) 更新確認コマンドを実行                                                   │
│      `mcpax update --check`                                                   │
│              │                                                              │
│              ▼                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│ システム (mcpax)                                                               │
├─────────────────────────────────────────────────────────────────────────────┤
│              │                                                              │
│  (2) config.toml を読み込む                                                  │
│      → Minecraft バージョン、Loader を取得                                   │
│              │                                                              │
│  (3) projects.toml を読み込む                                                    │
│      → 管理対象プロジェクト一覧を取得                                         │
│              │                                                              │
│  (4) 各プロジェクトについて Modrinth API に問い合わせ                          │
│      → 対応バージョンがあるか確認                                            │
│      → 最新バージョンを取得                                                  │
│              │                                                              │
│  (5) ローカルのインストール済みファイルと比較                                  │
│      → 更新があるプロジェクトを特定                                          │
│              │                                                              │
│  (6) 結果を表示                                                              │
│      ┌──────────────────────────────────────────┐                          │
│      │ 更新あり:                                │                          │
│      │   sodium: 0.5.0 → 0.6.0                 │                          │
│      │   lithium: 0.12.0 → 0.12.1              │                          │
│      │ 対応なし:                                │                          │
│      │   some-mod (1.21.4 未対応)               │                          │
│      │ 最新:                                    │                          │
│      │   fabric-api, iris, ...                 │                          │
│      └──────────────────────────────────────────┘                          │
│              │                                                              │
│              ▼                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│ 利用者                                                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│              │                                                              │
│  (7) 結果を確認                                                              │
│      → 更新したいプロジェクトがあるか判断                                     │
│              │                                                              │
│  (8) 更新コマンドを実行                                                       │
│      `mcpax update`                                                           │
│              │                                                              │
│              ▼                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│ システム (mcpax)                                                               │
├─────────────────────────────────────────────────────────────────────────────┤
│              │                                                              │
│  (9) 更新があるプロジェクトのファイルをダウンロード                            │
│      → ハッシュ検証                                                         │
│              │                                                              │
│ (10) 古いファイルをバックアップ                                               │
│              │                                                              │
│ (11) 新しいファイルを適切なディレクトリに配置                                  │
│      → MOD: mods/                                                          │
│      → Shader: shaderpacks/                                                │
│      → Resource Pack: resourcepacks/                                       │
│              │                                                              │
│ (12) 完了メッセージを表示                                                     │
│      ┌──────────────────────────────────────────┐                          │
│      │ ✓ sodium 0.6.0 をインストールしました      │                          │
│      │ ✓ lithium 0.12.1 をインストールしました    │                          │
│      └──────────────────────────────────────────┘                          │
│              │                                                              │
│              ▼                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│ 利用者                                                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│              │                                                              │
│ (13) 完了を確認                                                              │
│      → Minecraft を起動して動作確認                                          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 成果物

- 更新されたファイル（mods/, shaderpacks/, resourcepacks/ 内）
- バックアップされた古いファイル

---

## S-002: 新しいプロジェクトを追加する

### 前提条件

- config.toml が設定済み

### トリガー

- 新しい MOD/shader/リソースパックを使いたくなった

### 行動シナリオ

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 利用者                                                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  (1) 追加コマンドを実行                                                       │
│      `mcpax add sodium`                                                       │
│              │                                                              │
│              ▼                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│ システム (mcpax)                                                               │
├─────────────────────────────────────────────────────────────────────────────┤
│              │                                                              │
│  (2) Modrinth API でプロジェクトを検索                                        │
│      → slug が一致するか確認                                                 │
│      → プロジェクト情報を取得                                                │
│              │                                                              │
│  (3) プロジェクトの種類を判定                                                 │
│      → mod / shader / resourcepack                                         │
│              │                                                              │
│  (4) projects.toml に追加                                                        │
│              │                                                              │
│  (5) 確認メッセージを表示                                                     │
│      ┌──────────────────────────────────────────┐                          │
│      │ sodium (MOD) を追加しました               │                          │
│      │ `mcpax install sodium` でインストールできます │                          │
│      └──────────────────────────────────────────┘                          │
│              │                                                              │
│              ▼                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│ 利用者                                                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│              │                                                              │
│  (6) インストールコマンドを実行（任意）                                        │
│      `mcpax install sodium`                                                   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 成果物

- 更新された projects.toml

---

## S-003: プロジェクトを削除する

### 前提条件

- 削除したいプロジェクトが projects.toml に登録済み

### トリガー

- 使わなくなった MOD を整理したい

### 行動シナリオ

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 利用者                                                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  (1) 削除コマンドを実行                                                       │
│      `mcpax remove sodium`                                                    │
│              │                                                              │
│              ▼                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│ システム (mcpax)                                                               │
├─────────────────────────────────────────────────────────────────────────────┤
│              │                                                              │
│  (2) projects.toml から該当プロジェクトを検索                                     │
│              │                                                              │
│  (3) 確認プロンプトを表示                                                     │
│      ┌──────────────────────────────────────────┐                          │
│      │ sodium を削除しますか？                    │                          │
│      │ ファイルも削除しますか？ [y/N]             │                          │
│      └──────────────────────────────────────────┘                          │
│              │                                                              │
│              ▼                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│ 利用者                                                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│              │                                                              │
│  (4) 確認に応答                                                              │
│      → y: ファイルも削除                                                    │
│      → N: projects.toml からのみ削除                                            │
│              │                                                              │
│              ▼                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│ システム (mcpax)                                                               │
├─────────────────────────────────────────────────────────────────────────────┤
│              │                                                              │
│  (5) projects.toml から削除                                                      │
│              │                                                              │
│  (6) ファイル削除（選択した場合）                                              │
│              │                                                              │
│  (7) 完了メッセージを表示                                                     │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 成果物

- 更新された projects.toml
- （選択した場合）削除されたファイル

---

## S-004: 管理対象の一覧を確認する

### 前提条件

- projects.toml が存在する

### トリガー

- 現在の管理状況を把握したい

### 行動シナリオ

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 利用者                                                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  (1) 一覧コマンドを実行                                                       │
│      `mcpax list`                                                             │
│              │                                                              │
│              ▼                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│ システム (mcpax)                                                               │
├─────────────────────────────────────────────────────────────────────────────┤
│              │                                                              │
│  (2) projects.toml を読み込む                                                    │
│              │                                                              │
│  (3) 各プロジェクトのインストール状態を確認                                    │
│              │                                                              │
│  (4) 一覧を表示                                                              │
│      ┌──────────────────────────────────────────────────────────┐          │
│      │ MOD:                                                     │          │
│      │   ✓ fabric-api     0.97.0   (installed)                  │          │
│      │   ✓ sodium         0.6.0    (installed)                  │          │
│      │   ○ lithium        -        (not installed)              │          │
│      │                                                          │          │
│      │ Shader:                                                  │          │
│      │   ✓ complementary-reimagined  r5.2.2  (installed)        │          │
│      │                                                          │          │
│      │ Resource Pack:                                           │          │
│      │   ✓ faithful-64x   1.21.4   (installed)                  │          │
│      └──────────────────────────────────────────────────────────┘          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 成果物

- なし（情報表示のみ）

---

## S-005: 初期セットアップを行う

### 前提条件

- mcpax がインストール済み
- config.toml / projects.toml が存在しない

### トリガー

- 初めて mcpax を使う

### 行動シナリオ

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 利用者                                                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  (1) 初期化コマンドを実行                                                     │
│      `mcpax init`                                                             │
│              │                                                              │
│              ▼                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│ システム (mcpax)                                                               │
├─────────────────────────────────────────────────────────────────────────────┤
│              │                                                              │
│  (2) 対話的に設定を収集                                                       │
│      ┌──────────────────────────────────────────┐                          │
│      │ Minecraft バージョン: 1.21.4              │                          │
│      │ Loader: fabric                           │                          │
│      │ Minecraft ディレクトリ: ~/.minecraft      │                          │
│      └──────────────────────────────────────────┘                          │
│              │                                                              │
│  (3) config.toml を生成                                                      │
│              │                                                              │
│  (4) 空の projects.toml を生成                                                   │
│              │                                                              │
│  (5) 完了メッセージを表示                                                     │
│      ┌──────────────────────────────────────────┐                          │
│      │ 設定ファイルを作成しました                  │                          │
│      │ `mcpax add <slug>` でプロジェクトを追加してください │                     │
│      └──────────────────────────────────────────┘                          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 成果物

- config.toml
- projects.toml（空）

---

## S-006: プロジェクトを検索する

### 前提条件

- なし（設定ファイルがなくても検索可能）

### トリガー

- 追加したいプロジェクトの slug がわからない

### 行動シナリオ

```
┌─────────────────────────────────────────────────────────────────────────────┐
│ 利用者                                                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  (1) 検索コマンドを実行                                                       │
│      `mcpax search sodium`                                                    │
│              │                                                              │
│              ▼                                                              │
├─────────────────────────────────────────────────────────────────────────────┤
│ システム (mcpax)                                                               │
├─────────────────────────────────────────────────────────────────────────────┤
│              │                                                              │
│  (2) Modrinth API で検索                                                     │
│      → キーワードに一致するプロジェクトを取得                                  │
│              │                                                              │
│  (3) 検索結果を表示                                                           │
│      ┌──────────────────────────────────────────────────────────┐          │
│      │ 検索結果: "sodium"                                       │          │
│      │                                                          │          │
│      │ 1. sodium (mod)                                          │          │
│      │    Modern rendering engine and target for optimization   │          │
│      │    Downloads: 12,345,678                                  │          │
│      │                                                          │          │
│      │ 2. sodium-extra (mod)                                    │          │
│      │    Extra options for Sodium                              │          │
│      │    Downloads: 1,234,567                                   │          │
│      │                                                          │          │
│      │ 3. reese-sodium-options (mod)                            │          │
│      │    Alternative options menu for Sodium                   │          │
│      │    Downloads: 987,654                                     │          │
│      │                                                          │          │
│      │ `mcpax add <slug>` で追加できます                            │          │
│      └──────────────────────────────────────────────────────────┘          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 成果物

- なし（情報表示のみ）
